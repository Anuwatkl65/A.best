{% extends "production/base.html" %}
{% block title %}Data Collect{% endblock %}
{% block content %}
<h2 class="text-2xl font-bold mb-4 text-gray-800">Data Collect</h2>
<p class="text-gray-600 mb-4">ตัวอย่างหน้าแสดงข้อมูลจากแหล่งภายนอก (Google Sheet) — ตอนนี้ดึงจากฐาน SQLite/Mock ก่อน</p>

<div class="bg-white rounded-xl p-4 shadow">
  <table class="w-full text-sm">
    <thead class="text-gray-500">
      <tr>
        <th class="py-2 text-left">Lot</th>
        <th class="text-left">Part</th>
        <th class="text-left">Customer</th>
        <th class="text-right">Target</th>
      </tr>
    </thead>
    <tbody id="tbl"></tbody>
  </table>
</div>

<script>
  const SCRIPT_URL = "/api/";
  async function load(){
    const r = await fetch(SCRIPT_URL,{method:'POST',body:new URLSearchParams({action:'getData'})});
    const j = await r.json();
    const rows = (j.data?.dashboardData) || j.data || [];
    const tb = document.getElementById('tbl');
    tb.innerHTML = rows.map(x=>`
      <tr class="border-t">
        <td class="py-2">${x.lot_no||x.lotNo||'-'}</td>
        <td>${x.part_no||x.partNo||'-'}</td>
        <td>${x.customer||'-'}</td>
        <td class="text-right">${(x.target||0).toLocaleString()}</td>
      </tr>
    `).join('');
  }
  load();
</script>
{% endblock %}
